<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Fundraiser App</title>
</head>
<body>
    <h1>My Fundraiser App</h1>
    <p>This is a refactored version of the app to demonstrate secure handling of Firebase credentials for use with GitHub.</p>
    <p id="status-message">Loading Firebase...</p>

    <!--
        This is the new approach. We will load the Firebase configuration from a separate,
        untracked file that you will create. This keeps your API key secure and out of your Git history.
        You will need to create a file named 'firebase-keys.js' and add it to your .gitignore.
    -->
    <script src="./firebase-keys.js"></script>

    <script type="module">
        // Import necessary Firebase functions.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const statusMessageEl = document.getElementById('status-message');

        // Check if the firebaseConfig object is available from the separate file.
        // NOTE: Make sure to add `window.` before the firebaseConfig object in your firebase-keys.js file.
        if (typeof window.firebaseConfig !== 'undefined') {
            try {
                // Initialize Firebase with the loaded config.
                const app = initializeApp(window.firebaseConfig);
                const auth = getAuth(app);
                const db = getFirestore(app);

                statusMessageEl.textContent = "Firebase is successfully initialized and ready to go!";
                console.log("Firebase app:", app);
                console.log("Auth instance:", auth);
                console.log("Firestore instance:", db);

            } catch (error) {
                statusMessageEl.textContent = `Error initializing Firebase: ${error.message}`;
                console.error("Firebase initialization failed:", error);
            }
        } else {
            statusMessageEl.textContent = "Error: Firebase configuration is missing. Make sure 'firebase-keys.js' is created and linked correctly.";
            console.error("Firebase config object not found. Did you forget to create the file or add the config?");
        }
    </script>
</body>
</html>
